<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Mobility-omh | Daily Data</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://momentjs.com/downloads/moment.js"></script>


    <link href="stylesheets/normalize.css" rel="stylesheet" type="text/css"/>
    <link href="stylesheets/all.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="stylesheets/javascripts/draw.js"></script>
    <script type="text/javascript" src="stylesheets/javascripts/dsu.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>
  </head>

  <body class="index">
    <div class="mobility-page">
  <div class="top-area">
    <div class="row">
      <div class="col-xs-10 col-xs-offset-1">
        <div class="title">
          <h1 class="text-left">
            Mobility-omh
          </h1>
        </div>
      </div>
    </div>


    <!-- <div class="row">
      <div class="col-xs-11 col-xs-offset-1">
        <div class="btn-group btn-group-justified devices" role="group">
          <div class="btn-group" role="group">
            <button class="btn btn-primary btn-device selected" type="button" data="android">
              <span class="device-type">Android</span>
            </button>
          </div>
          <div class="btn-group" role="group">
            <button class="btn btn-success btn-device unselected" type='button' data='ios'>
              <span class="device-type">iPhone</span>
            </button>
          </div>
          <div class="btn-group" role="group">
            <button class="btn btn-device unselected" type="button" data="moves-app">
              <span class="device-type">Moves</span>
            </button>
          </div>
        </div>
      </div>
    </div>
 -->
    <div class="row">
      <div class="col-xs-11 col-xs-offset-1">
        <div class="date-area">
          <div class="btn-group btn-group-justified" role="group" aria-label="">
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-default" id="previous-date">Previous Day</button>
            </div>
            <div  class="btn-group" role="group">
              <button type="button" class="btn btn-default" id="current-date"></button>
            </div>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-default" id="next-date">Next Day</button>
            </div>

          </div>

        </div>

      </div>

    </div>
  </div>

  <div class="bottom-area">
    <hr>
    <div class="data-area">
      <div class="walking-data">
        <div class="row">
          <div class="col-xs-8 col-xs-offset-1">
            <h4>Miles Walked</h4>
          </div>
          <div class="col-xs-2 pull-right">
            <p id="walking-distance" class="pull-right">2.2</p>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-2 col-xs-offset-1">
            <img src="stylesheets/images/foot.png" class="data-icon">
          </div>
          <div class="col-xs-9">
            <table>
              <th style="float:right;" class="data-bar"><img src="stylesheets/images/arrow_down.png" class="arrow"><span class="data-difference">3.4</span></th>
              <tr class="padding data-bar" id="distance-bar">
                <td class="solid_border miles-walked-color"></td>
                <td></td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <hr>

      <div class="active-data">
        <div class="row">
          <div class="col-xs-8 col-xs-offset-1">
            <h4>Minutes Active</h4>
          </div>
          <div class="col-xs-2 pull-right">
            <p id="active-time" class="pull-right">43.2</p>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-2 col-xs-offset-1">
            <img src="stylesheets/images/active_heart.png"  class="data-icon">

          </div>
          <div class="col-xs-9">
            <table>
              <tr>
                <th style="float:right;" class="data-bar"><img src="stylesheets/images/arrow_down.png" class="arrow"><span class="data-difference">15.7</span></th>
              </tr>
              <tr class="padding" id="active-bar">
                <td class="solid_border minutes-active-color"></td>
                <td></td>
              </tr>
            </table>
          </div>

          <div class="col-xs-2">
          </div>
        </div>
      </div>

      <hr>

      <div class="home-data">
        <div class="row">
          <div class="col-xs-8 col-xs-offset-1">
            <h4>Hours Out of House</h4>
          </div>
          <div class="col-xs-2 pull-right">
            <p id="away-from-home" class="pull-right">12.4</p>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-2 col-xs-offset-1">
            <img src="stylesheets/images/home.png"  class="data-icon">
          </div>
          <div class="col-xs-9">
            <table>
              <tr>
                <th style="float:right;" class="data-bar"><img src="stylesheets/images/arrow_up.png" class="arrow"><span class="data-difference">1.3</span></th>
              </tr>
              <tr class="padding" id="away-bar">
                <td class="solid_border hours-out-of-house-color"></td>
                <td></td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <hr>

    </div>


    <div class="location-area">
      <div class="map-title">
        <h3 class="text-center"><img src="stylesheets/images/location.png" style="height:2em;">  Places Visited</h3>
      </div>

      <div id="google-locations">
        <hr>
        <div class="location-unit">
          <div class="row location-info">
            <div class="col-xs-8 col-xs-offset-1">
             <!--  <img src="images/location.png" style="height: 3em;"> -->
              <p class="locations">Prospect Park, Brooklyn, NY</p>
            </div>

            <div class="col-xs-2 col-xs-offset-1">
              <!-- <img src="images/time.png" style="height: 3em;"> -->
              <p class="time">12:43</p>
            </div>
          </div>

          <div class="maps">
            <img src="stylesheets/images/street_view.png" width="100%">
          </div>
          <hr>
        </div>


        <div class="location-unit">
          <div class="row location-info">
            <div class="col-xs-8 col-xs-offset-1">
             <!--  <img src="images/location.png" style="height: 3em;"> -->
              <p class="locations">Prospect Park, Brooklyn, NY</p>
            </div>

            <div class="col-xs-2 col-xs-offset-1">
              <!-- <img src="images/time.png" style="height: 3em;"> -->
              <p class="time">12:43</p>
            </div>
          </div>

          <div class="maps">
            <img src="stylesheets/images/street_view.png" width="100%">
          </div>
        </div>

        <hr>
      </div>
    </div>
  </div>

</div>


<script type="text/javascript">
    $(document).ready(function() {
        var today = moment();
        console.log(today);
        $('#current-date').html(today.format('dddd, MMMM Do YYYY'));

        $('#next-date').click(function(){
          var tomorrow = moment(today).add('days', 1);
          console.log(tomorrow);
          today = moment(today).add('days', 1);
          console.log(today);
          $('#current-date').html(today.format('dddd, MMMM Do YYYY'));
          redraw();
        });

        $('#previous-date').click(function(){
          var yesterday = moment(today).subtract('days', 1);
          console.log(yesterday);
          today = moment(today).subtract('days', 1);
          console.log(today);
          $('#current-date').html(today.format('dddd, MMMM Do YYYY'));
          redraw();
        });

        $('#current-date').click(function(){
          var today = moment();
          $('#current-date').html(today.format('dddd, MMMM Do YYYY'));
          redraw();
        });

        var token = url("#access_token");

        if(!token)
        {
            window.location.href = dsu + "oauth/authorize?client_id=mobility-visualization&response_type=token";
        }
        else
        {
            $.getJSON(dsu + "oauth/check_token?token=" + token)
            .done(function(data) {
                var username = data["user_name"];
                var device = url("#device") || "android";
                var date = url("#date")? moment(url("#date")).toDate() : new Date();
                var redraw = function(){
                    deletePreviousImg();
                    drawDate(username, moment(date).format('YYYY-MM-DD'), device, token);
                    deletePreviousBar();
                    showSummary(username, date, device, token);
                };
            })
            .fail(function() {
                window.location.href = dsu + "oauth/authorize?client_id=mobility_visualization&response_type=token";
            });
        }
    } );
</script>
  </body>
</html>
